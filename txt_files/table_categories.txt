Table categories

    Exploits & tools
    - Malware family
    - IOC
    - Family name
    - Threat actor
        * groups & threat actors

    - campaigns
    - Platform
    - exploit type

    Mitre data - obtain from json & attach to specified threat actors
    *create script to always update this file and incase of any changes,redo all configs

    Combine IOCs with Mitre data

    Table formation

    Main table = Software
     sub-tables = IOCs


# attaches IOCs to software_category
""" for label in malware_category:
    label['malware_family'] = set()
    label['ioc'] = set()
    malware_family = requests.post(
        threatfox_url,
        data=json.dumps({'query': 'taginfo','tag': label.get('name')})
        )
    if malware_family.json().get('query_status') == 'ok':
        for x in malware_family.json().get('data'):
            label['malware_family'].add(x.get('malware'))
            label['ioc'].add(x.get('ioc'))

    #the goal is to not get IP blocked
    time.sleep(10) """


    All ioc categories
    Tables
    - 'url.payload_delivery'
    - 'url.botnet_cc'
    - 'domain.payload_delivery'
    - 'domain.botnet_cc'
    - 'domain.cc_skimming'
    - 'ip:port.payload_delivery'
    - 'ip:port.botnet_cc'
    - 'envelope_from.payload_delivery'
    - 'body_from.payload_delivery'
    - 'md5_hash.payload'
    - 'sha256_hash.payload'
    - 'sha3_384_hash.payload'
    - 'sha1_hash.payload'

    content(IocBaseModel)
    - unique_id - NN, Unique
    - 'ioc_value' - NN
    - 'ioc_type' - NN
    - 'threat_type' - NN
    - 'malware' - NN
    - 'first_seen_utc' - NN
    - 'confidence_level' - NN
    - 'tags' - NN
    - 'malware_printable' - NN
    - 'reporter' - NN
    - 'reference'
    - 'last_seen_utc'
    - 'malware_alias'
    - 'anonymous'

    links(Mitre)
    - main : groups
    - second : campaigns
    - linked to everything else: software

    groups {
        campaigns
        software
    }
    campaigns {
        campaigns
        software
    }
    - use software to generate all items
    - get the software and all groups associated and the campaigns
    - 